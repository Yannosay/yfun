<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tic Tac Toe</title>
<style>
body {
    margin: 0;
    font-family: Segoe UI, Arial;
    background: #070b18;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden;
}

#bg { position: fixed; inset: 0; z-index: -1; }
.hidden { display: none; }

.menu, #aiMenu { text-align: center; animation: fadeIn 1s ease; }

.menu h1, #aiMenu h1 { font-size: 60px; letter-spacing: 6px; margin-bottom: 40px; }

.menu button, #aiMenu button {
    padding: 18px 60px;
    font-size: 20px;
    border: none;
    border-radius: 14px;
    background: #1e2746;
    color: white;
    cursor: pointer;
    transition: .3s;
}

.menu button:hover, #aiMenu button:hover { transform: scale(1.08); background: #2b3a7a; }

.ai-extreme:hover { animation: shake 0.3s infinite alternate; text-shadow: 0 0 8px #ff0, 0 0 15px #f00; }
@keyframes shake { 0%{transform:translate(0,0)} 25%{transform:translate(3px,-2px)} 50%{transform:translate(-3px,2px)} 75%{transform:translate(2px,-2px)} 100%{transform:translate(-2px,2px)} }

.wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 14px;
    z-index: 1;
}

.score { display:flex; gap:20px; align-items:center; font-size:20px; }
.score button { background:#1e2746; border:none; color:white; padding:8px 18px; border-radius:8px; cursor:pointer; }

.boardWrap { position: relative; }
#winSvg { position:absolute; inset:0; pointer-events:none; z-index:2; }

.winLine {
    stroke: white;
    stroke-width: 8;
    stroke-linecap: round;
    stroke-dasharray: 600;
    stroke-dashoffset: 600;
    filter: drop-shadow(0 0 10px #fff);
}
.winLine.show { animation: draw .5s ease forwards; }

.board {
    display: grid;
    grid-template-columns: repeat(3,120px);
    grid-template-rows: repeat(3,120px);
    border: 2px solid #2a335c;
    box-shadow: 0 0 40px #000;
    background: #0a0f22;
    z-index: 1;
}

.cell {
    border: 1px solid #1d2442;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 90px;
    cursor: pointer;
    transition: .2s;
    position: relative;
}

.cell:hover { transform: scale(1.05); background: #151c3b; }
.cell.x { background: #381919; }
.cell.o { background: #123828; }
.cell.glow { box-shadow: 0 0 20px #fff inset, 0 0 20px #fff; }

.turn { font-size:20px; margin-top:10px; }
button { margin-top:10px; padding:10px 30px; border:none; border-radius:10px; cursor:pointer; }
#menuBtn { background:#1e2746; color:white; }
#rematchBtn { background:#2a7a4b; color:white; }

@keyframes fadeIn { from { opacity:0; transform:translateY(20px)} to { opacity:1; transform:none } }
</style>
</head>
<body>

<canvas id="bg"></canvas>

<div id="menu" class="menu">
    <h1>TIC TAC TOE</h1>
    <button id="startBtn">START GAME</button>
    <button id="aiBtn">PLAY vs AI</button>
</div>

<div id="aiMenu" class="hidden">
    <h1>SELECT AI DIFFICULTY</h1>
    <button class="level-btn" data-level="easy">Easy</button>
    <button class="level-btn" data-level="normal">Normal</button>
    <button class="level-btn ai-extreme" data-level="extreme">Extreme</button>
    <br>
    <button id="backBtn">Back</button>
</div>

<div class="wrap hidden" id="gameWrap">
    <h1>Tic Tac Toe</h1>
    <div class="score">
        <div>X: <span id="scoreX">0</span></div>
        <div>O: <span id="scoreO">0</span></div>
        <button id="resetScore">Reset Points</button>
    </div>
    <div class="boardWrap">
        <svg id="winSvg"></svg>
        <div id="board" class="board"></div>
    </div>
    <div class="turn" id="turnText"></div>
    <button id="menuBtn">Main Menu</button>
    <button id="rematchBtn">Rematch</button>
</div>

<script>
const menu=document.getElementById("menu"),aiMenu=document.getElementById("aiMenu"),startBtn=document.getElementById("startBtn"),aiBtn=document.getElementById("aiBtn"),backBtn=document.getElementById("backBtn"),levelBtns=document.querySelectorAll(".level-btn"),gameWrap=document.getElementById("gameWrap"),boardEl=document.getElementById("board"),turnText=document.getElementById("turnText"),resetScoreBtn=document.getElementById("resetScore"),menuBtn=document.getElementById("menuBtn"),rematchBtn=document.getElementById("rematchBtn"),scoreXEl=document.getElementById("scoreX"),scoreOEl=document.getElementById("scoreO"),svg=document.getElementById("winSvg");
let score={x:0,o:0},board=[],current="x",finished=false,winLine=null,vsAI=false,aiLevel="easy";

updateScore()
gameWrap.classList.add("hidden")
menu.classList.remove("hidden")

function updateScore(){scoreXEl.textContent=score.x;scoreOEl.textContent=score.o}
resetScoreBtn.onclick=()=>{score={x:0,o:0};updateScore()}
menuBtn.onclick=()=>{gameWrap.classList.add("hidden");menu.classList.remove("hidden")}
startBtn.onclick=()=>{vsAI=false;menu.classList.add("hidden");gameWrap.classList.remove("hidden");startGame()}
aiBtn.onclick=()=>{menu.classList.add("hidden");aiMenu.classList.remove("hidden")}
backBtn.onclick=()=>{aiMenu.classList.add("hidden");menu.classList.remove("hidden")}
levelBtns.forEach(btn=>btn.onclick=()=>{vsAI=true;aiLevel=btn.dataset.level;aiMenu.classList.add("hidden");gameWrap.classList.remove("hidden");startGame()})
rematchBtn.onclick=()=>startGame()

function resizeSvg(){const r=boardEl.getBoundingClientRect();svg.setAttribute("width",r.width);svg.setAttribute("height",r.height);svg.setAttribute("viewBox",`0 0 ${r.width} ${r.height}`)}
function startGame(){board=["","","","","","","","",""];current="x";finished=false;svg.innerHTML="";drawBoard();resizeSvg();updateTurn();if(vsAI&&current==="o") setTimeout(aiMove,300)}
function drawBoard(){boardEl.innerHTML="";board.forEach((v,i)=>{let c=document.createElement("div");c.className="cell "+v;if(v!=="") c.classList.add("filled");c.textContent=v.toUpperCase();c.onclick=()=>clickCell(i);boardEl.appendChild(c)})}
function updateTurn(){turnText.textContent="Player "+current.toUpperCase()+"'s turn"}
function clickCell(i){if(finished||board[i]) return;board[i]=current;drawBoard();check();if(!finished){current=current==="x"?"o":"x";updateTurn();if(vsAI&&current==="o") setTimeout(aiMove,300)}}
function aiMove(){let empty=board.map((v,i)=>v===""?i:-1).filter(i=>i!==-1);if(empty.length===0) return;let move;switch(aiLevel){case"easy":move=empty[Math.floor(Math.random()*empty.length)];break;case"normal":move=empty[Math.floor(Math.random()*empty.length)];break;case"extreme":move=minimaxMove();break} clickCell(move)}
function minimaxMove(){let best=-1,maxScore=-Infinity;board.forEach((v,i)=>{if(v===""){board[i]="o";let s=minimax(board,false);board[i]="";if(s>maxScore){maxScore=s;best=i}}});return best}
function minimax(b,isO){let w=checkWinner(b);if(w==="o")return 1;if(w==="x")return -1;if(w==="draw")return 0;let scores=[];b.forEach((v,i)=>{if(v===""){b[i]=isO?"o":"x";scores.push(minimax(b,!isO));b[i]=""}});return isO?Math.max(...scores):Math.min(...scores)}
function checkWinner(b){const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(let w of wins){let [a,b1,c]=w;if(b[a]&&b[a]===b[b1]&&b[a]===b[c])return b[a]}return b.every(x=>x)? "draw":null}
function check(){const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(let w of wins){let [a,b1,c]=w;if(board[a]&&board[a]===board[b1]&&board[a]===board[c]){win(w);return}};if(board.every(x=>x)) draw()}
function win(w){finished=true;score[current]++;updateScore();turnText.textContent="Player "+current.toUpperCase()+" Wins!";drawWinLine(w);w.forEach(i=>boardEl.children[i].classList.add("glow"))}
function draw(){finished=true;turnText.textContent="Draw"}
function drawWinLine(w){resizeSvg();const cs=boardEl.children[0].offsetWidth;const pad=cs*0.2;const getC=i=>{const r=Math.floor(i/3),c=i%3;return{x:c*cs+cs/2,y:r*cs+cs/2}};let s=getC(w[0]),e=getC(w[2]);const dx=e.x-s.x,dy=e.y-s.y,len=Math.hypot(dx,dy);const ux=dx/len,uy=dy/len;s.x-=ux*pad;s.y-=uy*pad;e.x+=ux*pad;e.y+=uy*pad;winLine=document.createElementNS("http://www.w3.org/2000/svg","line");winLine.setAttribute("x1",s.x);winLine.setAttribute("y1",s.y);winLine.setAttribute("x2",e.x);winLine.setAttribute("y2",e.y);winLine.classList.add("winLine");svg.appendChild(winLine);setTimeout(()=>winLine.classList.add("show"),10)}

/* animated background */
const canvas=document.getElementById("bg");const ctx=canvas.getContext("2d")
function resize(){canvas.width=window.innerWidth;canvas.height=window.innerHeight}
window.onresize=()=>{resize();resizeSvg()}
resize()
let stars=Array.from({length:80},()=>({x:Math.random()*canvas.width,y:Math.random()*canvas.height,s:Math.random()*2}))
function bg(){ctx.clearRect(0,0,canvas.width,canvas.height);ctx.fillStyle="#6b7cff";stars.forEach(st=>{ctx.globalAlpha=Math.random();ctx.fillRect(st.x,st.y,st.s,st.s)});requestAnimationFrame(bg)}
bg()
</script>

</body>
</html>
